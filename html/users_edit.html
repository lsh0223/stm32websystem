<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if user %}编辑用户{% else %}新增用户{% endif %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body class="bg-light">
    <div class="container mt-5" style="max-width: 600px;">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">{% if user %}编辑用户{% else %}新增用户{% endif %}</h4>
        </div>
        <div class="card-body">
          <form method="POST">
            
            <div class="mb-3">
              <label class="form-label">卡号 (UID)</label>
              <input type="text" name="card_uid" class="form-control" 
                     value="{{ user.card_uid if user else '' }}" required
                     {% if user %}readonly{% endif %}>
              <div class="form-text">请填写卡片 UID (如 031368FC)</div>
            </div>

            <div class="mb-3">
              <label class="form-label">用户名</label>
              <input type="text" name="username" class="form-control" 
                     value="{{ user.username if user else '' }}" required>
            </div>

            <div class="mb-3">
              <label class="form-label">身份证号</label>
              <input type="text" name="id_card" class="form-control" 
                     value="{{ user.id_card if user else '' }}" required
                     placeholder="请输入18位身份证号">
              <div class="form-text">系统将自动计算年龄和生日</div>
            </div>

            {% if not user %}
            <div class="mb-3">
              <label class="form-label">初始余额 (元)</label>
              <input type="number" step="0.01" name="balance" class="form-control" value="0.00">
            </div>
            {% endif %}

            {% if user %}
            <div class="mb-3 form-check">
              <input type="checkbox" name="is_active" class="form-check-input" id="activeCheck"
                     {% if user.is_active %}checked{% endif %}>
              <label class="form-check-label" for="activeCheck">账户启用</label>
            </div>
            {% endif %}

            <div class="d-flex justify-content-between">
              <a href="/users" class="btn btn-secondary">返回</a>
              <button type="submit" class="btn btn-primary">保存</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </body>
</html>